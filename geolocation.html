var Testing = function(processingInstance) {
    with (processingInstance) {
        var canvasSize = 800;
        size(canvasSize,canvasSize); 
        frameRate(30);
        
        // ProgramCodeGoesHere

         var FirstColor = color(0, 0, 0);
         var SecondColor = color(135,10,10);
         var ThirdColor = color(70,50,168);
         var BoxColor = color(255,255,255);
         var SelectBoxColor = color(0,255,200);
         var BackColor = color(180,200,240);
         stroke(FirstColor);
         strokeWeight(2);

         var Lat = 0;
         var Long = 0;
         var Lat1 = 0;
         var Long1 = 0;        
         var Lat2 = 0;
         var Long2 = 0;
         var Dist1_2=0;        

        var getLocation = function() {
            if (navigator.geolocation) {
                console.log('geolocation supported');
                navigator.geolocation.getCurrentPosition(savePosition);
            } else { 
                console.log("Geolocation is not supported by this browser.");
            }
        }
        function savePosition(position) {
            console.log("Made it to savePosition");
            Lat = position.coords.latitude;
            Long = position.coords.longitude;           
        }


        function distance(Lat1, Lon1, Lat2, Lon2) {
            if ((Lat1 == Lat2) && (Lon1 == Lon2)) {
                return 0;
            }
            else {
                var radlat1 = Math.PI * Lat1/180;
                var radlat2 = Math.PI * Lat2/180;
                var theta = Lon1-Lon2;
                var radtheta = Math.PI * theta/180;
                var dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta);
                if (dist > 1) {
                    dist = 1;
                }
                dist = Math.acos(dist);
                dist = dist * 180/Math.PI;
                dist = dist * 60 * 1.1515 * 5280;
                return dist;
            }
        }


        mouseClicked = function() {

            if(mouseX>=50 && mouseX<=350 && mouseY>=200 && mouseY<=300) {
               getLocation()
               Lat1=Lat
               Long1=Long
               Dist1_2=distance();
            }            
            getLocation();
            if(mouseX>=450 && mouseX<=750 && mouseY>=200 && mouseY<=300) {
               getLocation()
               Lat2=Lat
               Long2=Long
               Dist1_2=distance();
            }            
        }


        var Count=0;
        draw = function() {
        background(BackColor);


            fill(BoxColor);
            
            rect(50,200,300,100);
            rect(450,200,300,100);

            textSize(40);
            textAlign(CENTER);
            fill(FirstColor);


            text("Get 1st Point",200,280);
            text("Get 2nd Point",600,280);
            text("Lat  ="+Lat1.toFixed(3),200,350);
            text("Long ="+Long1.toFixed(3),200,400);
            text("Lat  ="+Lat2.toFixed(3),600,350);
            text("Long ="+Long2.toFixed(3),600,400);
            text(Dist1_2+" Feet",400,450)
            console.log(Dist1_2,Lat.toFixed(3),Lat1.toFixed(3),Lat2.toFixed(3),Long.toFixed(3),Long1.toFixed(3),Long2.toFixed(3));

        }




}
};

    // Get the canvas that Processing-js will use
    var canvas = document.getElementById("mycanvas"); 
    // Pass the function sketchProc (defined in myCode.js) to Processing's constructor.
    var processingInstance = new Processing(canvas, Testing); 